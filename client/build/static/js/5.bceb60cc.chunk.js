(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[5],{204:function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"d",(function(){return u})),n.d(t,"f",(function(){return l})),n.d(t,"c",(function(){return p})),n.d(t,"j",(function(){return m})),n.d(t,"h",(function(){return d})),n.d(t,"e",(function(){return f})),n.d(t,"g",(function(){return h})),n.d(t,"k",(function(){return b})),n.d(t,"a",(function(){return g})),n.d(t,"i",(function(){return v}));var r=n(12),a=n.n(r),o=n(29),c=n(25),s=n.n(c),i=function(){var e=Object(o.a)(a.a.mark((function e(t,n,r){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s.a.post("/api/post/new/".concat(t),r,{headers:{Authorization:"Bearer ".concat(n)}}).then((function(e){return e.data})).catch((function(e){return e}));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t,n,r){return e.apply(this,arguments)}}(),u=function(){var e=Object(o.a)(a.a.mark((function e(){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s.a.get("/api/post").then((function(e){return console.log(e),e.data})).catch((function(e){return console.log(e),e}));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),l=function(){var e=Object(o.a)(a.a.mark((function e(t){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s.a.get("/api/post/?page=".concat(t)).then((function(e){return console.log(e),e.data})).catch((function(e){return console.log(e.response),e.response}));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),p=function(e,t,n){return fetch("/api/post/like",{method:"PUT",headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer ".concat(t)},body:JSON.stringify({userId:e,postId:n})}).then((function(e){return e.json()})).catch((function(e){return console.log(e)}))},m=function(e,t,n){return fetch("/api/post/unlike",{method:"PUT",headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer ".concat(t)},body:JSON.stringify({userId:e,postId:n})}).then((function(e){return e.json()})).catch((function(e){return console.log(e)}))},d=function(){var e=Object(o.a)(a.a.mark((function e(t){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s.a.get("/api/post/".concat(t)).then((function(e){return e.data})).catch((function(e){return e}));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),f=function(){var e=Object(o.a)(a.a.mark((function e(t,n){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s.a.get("/api/post/by/".concat(t),{headers:{Authorization:"Bearer ".concat(n)}}).then((function(e){return e.data.result})).catch((function(e){return console.error(e)}));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),h=function(){var e=Object(o.a)(a.a.mark((function e(t,n){var r;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch("/api/post/".concat(t),{method:"DELETE",headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer ".concat(n)}});case 3:return r=e.sent,e.abrupt("return",r.json());case 7:return e.prev=7,e.t0=e.catch(0),e.abrupt("return",console.log(e.t0));case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t,n){return e.apply(this,arguments)}}(),b=function(){var e=Object(o.a)(a.a.mark((function e(t,n,r){var o;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,s()("/api/post/".concat(t),{method:"PUT",headers:{Accept:"application/json",Authorization:"Bearer ".concat(n)},data:r});case 3:if(!(o=e.sent)){e.next=6;break}return e.abrupt("return",o);case 6:e.next=13;break;case 8:if(e.prev=8,e.t0=e.catch(0),console.error(e.t0),!e.t0.response.data){e.next=13;break}return e.abrupt("return",e.t0.response.data);case 13:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t,n,r){return e.apply(this,arguments)}}(),g=function(e,t,n,r){return fetch("/api/post/comment",{method:"PUT",headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer ".concat(t)},body:JSON.stringify({userId:e,postId:n,comment:r})}).then((function(e){return e.json()})).catch((function(e){return console.log(e)}))},v=function(e,t,n,r){return fetch("/api/post/uncomment",{method:"PUT",headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer ".concat(t)},body:JSON.stringify({userId:e,postId:n,comment:r})}).then((function(e){return e.json()})).catch((function(e){return console.log(e)}))}},205:function(e,t,n){e.exports=n.p+"static/media/Default.2aee7378.png"},210:function(e,t,n){e.exports=n.p+"static/media/Logo.2aee7378.png"},251:function(e,t,n){"use strict";n.r(t);var r=n(80),a=n(81),o=n(83),c=n(82),s=n(0),i=n.n(s),u=n(204),l=n(18),p=n(9),m=n(11),d=n(205),f=n.n(d),h=function(e){Object(o.a)(n,e);var t=Object(c.a)(n);function n(){var e;Object(r.a)(this,n);for(var a=arguments.length,o=new Array(a),c=0;c<a;c++)o[c]=arguments[c];return(e=t.call.apply(t,[this].concat(o))).state={text:"",error:""},e.handleChange=function(t){e.setState({error:""}),e.setState({text:t.target.value})},e.isValid=function(){var t=e.state.text;return!(!t.length>0||t.length>150)||(e.setState({error:"Comment should not be empty and less than 150 characters long"}),!1)},e.addComment=function(t){if(t.preventDefault(),!Object(m.c)())return e.setState({error:"Please signin to leave a comment"}),!1;if(e.isValid()){var n=Object(m.c)().user._id,r=Object(m.c)().token,a=e.props.postId;Object(u.a)(n,r,a,{text:e.state.text}).then((function(t){console.log(t),t.error?console.log(t.error):(e.setState({text:""}),e.props.updateComments(t.comments))}))}},e.deleteComment=function(t){var n=Object(m.c)().user._id,r=Object(m.c)().token,a=e.props.postId;Object(u.i)(n,r,a,t).then((function(t){t.error?console.log(t.error):e.props.updateComments(t.comments)}))},e.deleteConfirmed=function(t){window.confirm("Are you sure you want to delete your comment?")&&e.deleteComment(t)},e}return Object(a.a)(n,[{key:"render",value:function(){var e=this,t=this.props.comments,n=this.state.error;return i.a.createElement("div",null,i.a.createElement("h2",{className:"mt-5 mb-5"},"Leave a comment"),i.a.createElement("form",{onSubmit:this.addComment},i.a.createElement("div",{className:"form-group"},i.a.createElement("input",{type:"text",onChange:this.handleChange,value:this.state.text,className:"form-control",placeholder:"Leave a comment..."}),i.a.createElement("button",{className:"btn btn-raised btn-success mt-2"},"Post"))),i.a.createElement("div",{className:"alert alert-danger",style:{display:n?"":"none"}},n),i.a.createElement("div",{className:"col-md-12"},i.a.createElement("h3",{className:"text-primary"},t.length," Comments"),i.a.createElement("hr",null),t.map((function(t,n){return i.a.createElement("div",{key:n},i.a.createElement("div",null,i.a.createElement(l.b,{to:"/user/".concat(t.postedBy)},i.a.createElement("img",{style:{borderRadius:"50%",border:"1px solid black"},className:"float-left mr-2",height:"30px",width:"30px",onError:function(e){return e.target.src="".concat(f.a)},src:"/api/user/photo/".concat(t.postedBy),alt:t.postedBy.name})),i.a.createElement("div",null,i.a.createElement("p",{className:"lead"},t.text),i.a.createElement("p",{className:"font-italic mark"},"Posted by"," ",i.a.createElement(l.b,{to:"/user/".concat(t.postedBy)},t.postedBy.name," "),"on ",new Date(t.created).toDateString(),i.a.createElement("span",null,Object(m.c)().user&&Object(m.c)().user._id===t.postedBy&&i.a.createElement(i.a.Fragment,null,i.a.createElement("span",{onClick:function(){return e.deleteConfirmed(t)},className:"text-danger float-right mr-1"},"Remove")))))))}))))}}]),n}(s.Component),b=n(210),g=n.n(b),v=function(e){Object(o.a)(n,e);var t=Object(c.a)(n);function n(){var e;Object(r.a)(this,n);for(var a=arguments.length,o=new Array(a),c=0;c<a;c++)o[c]=arguments[c];return(e=t.call.apply(t,[this].concat(o))).state={post:"",redirectToHome:!1,redirectToSignin:!1,like:!1,likes:0,comments:[]},e.checkLike=function(e){var t=Object(m.c)()&&Object(m.c)().user._id;return-1!==e.indexOf(t)},e.componentDidMount=function(){var t=e.props.match.params.postId;Object(u.h)(t).then((function(t){e.setState({post:t,likes:t.likes.length,comments:t.comments,like:e.checkLike(t.likes)})})).catch((function(e){return console.log(e)}))},e.updateComments=function(t){e.setState({comments:t})},e.likeToggle=function(){if(!Object(m.c)())return e.setState({redirectToSignin:!0}),!1;var t=e.state.like?u.j:u.c,n=Object(m.c)().user._id,r=e.state.post._id;t(n,Object(m.c)().token,r).then((function(t){t.error?console.log(t.error):e.setState({like:!e.state.like,likes:t.likes.length})}))},e.deletePost=function(){var t=e.props.match.params.postId,n=Object(m.c)().token;Object(u.g)(t,n).then((function(t){t.error?console.log(t.error):e.setState({redirectToHome:!0})}))},e.deleteConfirmed=function(){window.confirm("Are you sure you want to delete your post?")&&e.deletePost()},e.renderPost=function(t){var n=t.postedBy?"/user/".concat(t.postedBy._id):"",r=t.postedBy?t.postedBy.name:" Unknown",a=e.state,o=a.like,c=a.likes;return i.a.createElement("div",{className:"card-body mb-5"},i.a.createElement(l.b,{to:"/",className:"btn btn-raised btn-link btn-md"},"Back to posts"),i.a.createElement("h2",null,t.title),i.a.createElement("img",{src:"/api/post/photo/".concat(t._id),alt:t.title,onError:function(e){return e.target.src="".concat(g.a)},className:"img-fluid mb-3",style:{height:"300px",width:"100%",objectFit:"cover",backgroundColor:"#0E2F56"}}),o?i.a.createElement("h3",{onClick:e.likeToggle},i.a.createElement("i",{className:"thumbs up outline icon text-success",style:{padding:"10px",borderRadius:"50%"}})," ",c," Like"):i.a.createElement("h3",{onClick:e.likeToggle},i.a.createElement("i",{className:"thumbs up outline icon text-warning",style:{padding:"10px",borderRadius:"50%"}})," ",c," Like"),i.a.createElement("hr",null),i.a.createElement("div",{className:"container",dangerouslySetInnerHTML:{__html:t.body}}),i.a.createElement("br",null),i.a.createElement("p",{className:"font-italic mark"},"Posted by ",i.a.createElement(l.b,{to:"".concat(n)},r," "),"on ",new Date(t.created).toDateString()),Object(m.c)().user&&Object(m.c)().user._id===t.postedBy._id&&i.a.createElement("div",null,i.a.createElement(l.b,{to:"/posts/edit/".concat(t._id),className:"btn btn-raised btn-info btn-md"},"Update Post"),i.a.createElement("button",{onClick:e.deleteConfirmed,className:"btn btn-raised btn-md btn-danger"},"Delete Post")),i.a.createElement("div",null,Object(m.c)().user&&"admin"===Object(m.c)().user.role&&i.a.createElement("div",{className:"card mt-5"},i.a.createElement("div",{className:"card-body"},i.a.createElement("h5",{className:"card-title"},"Admin"),i.a.createElement("p",{className:"mb-2 text-danger"},"Edit/Delete as an Admin"),i.a.createElement(l.b,{to:"/posts/edit/".concat(t._id),className:"btn btn-raised btn-warning btn-sm mr-5"},"Update Post"),i.a.createElement("button",{onClick:e.deleteConfirmed,className:"btn btn-raised btn-danger"},"Delete Post")))))},e}return Object(a.a)(n,[{key:"render",value:function(){var e=this.state,t=e.post,n=e.redirectToHome,r=e.redirectToSignin,a=e.comments;return n?i.a.createElement(p.a,{to:"/"}):r?i.a.createElement(p.a,{to:"/login"}):i.a.createElement("div",{className:"container mt-5 mb-5"},t?this.renderPost(t):i.a.createElement("div",{className:"jumbotron text-center"},i.a.createElement("h2",null,"Loading...")),i.a.createElement(h,{postId:t._id,comments:a.reverse(),updateComments:this.updateComments}))}}]),n}(s.Component);t.default=v}}]);
//# sourceMappingURL=5.bceb60cc.chunk.js.map