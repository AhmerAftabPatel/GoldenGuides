{"version":3,"sources":["post/apiPost.js","post/Post.js"],"names":["create","userId","token","post","a","axios","headers","Authorization","then","res","data","catch","err","list","get","console","log","pageList","page","response","like","postId","fetch","method","Accept","body","JSON","stringify","json","unlike","singlePost","id","listByUser","result","error","remove","update","comment","uncomment","Post","handleChange","name","event","setState","value","target","files","fileSize","size","postData","append","clickSubmit","preventDefault","loading","isValid","isAuthenticated","user","_id","redirect","title","photo","state","length","this","FormData","to","className","style","marginTop","padding","color","onSubmit","encType","type","accept","required","onChange","autoCapitalize","autoComplete","htmlFor","onInit","editor","ui","getEditableElement","parentElement","insertBefore","view","toolbar","element","getData","DecoupledEditor","onClick","props","history","push","Component"],"mappings":"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","file":"static/js/11.1fa4831c.chunk.js","sourcesContent":["import axios from \"axios\";\n\nexport const create = async (userId, token, post) => {\n  return await axios\n    .post(`/api/post/new/${userId}`, post, {\n      headers: { Authorization: `Bearer ${token}` },\n    })\n    .then((res) => res.data)\n    .catch((err) => err);\n};\n\nexport const list = async () => {\n  return await axios\n    .get(`/api/post`)\n    .then((res) => {\n      console.log(res);\n      return res.data;\n    })\n    .catch((err) => {\n      console.log(err);\n      return err;\n    });\n};\nexport const pageList = async (page) => {\n  return await axios\n    .get(`/api/post/?page=${page}`)\n    .then((res) => {\n      console.log(res);\n      return res.data;\n    })\n    .catch((err) => {\n      console.log(err.response);\n      return err.response;\n    });\n};\n\nexport const like = (userId, token, postId) => {\n  return fetch(`/api/post/like`, {\n    method: \"PUT\",\n    headers: {\n      Accept: \"application/json\",\n      \"Content-Type\": \"application/json\",\n      Authorization: `Bearer ${token}`,\n    },\n    body: JSON.stringify({ userId, postId }),\n  })\n    .then((response) => {\n      return response.json();\n    })\n    .catch((err) => console.log(err));\n};\n\nexport const unlike = (userId, token, postId) => {\n  return fetch(`/api/post/unlike`, {\n    method: \"PUT\",\n    headers: {\n      Accept: \"application/json\",\n      \"Content-Type\": \"application/json\",\n      Authorization: `Bearer ${token}`,\n    },\n    body: JSON.stringify({ userId, postId }),\n  })\n    .then((response) => {\n      return response.json();\n    })\n    .catch((err) => console.log(err));\n};\nexport const singlePost = async (id) => {\n  return await axios\n    .get(`/api/post/${id}`)\n    .then((res) => res.data)\n    .catch((err) => err);\n};\nexport const listByUser = async (userId, token) => {\n  return await axios\n    .get(`/api/post/by/${userId}`, {\n      headers: { Authorization: `Bearer ${token}` },\n    })\n    .then((res) => res.data.result)\n    .catch((err) => console.error(err));\n};\nexport const remove = async (postId, token) => {\n  try {\n    const response = await fetch(`/api/post/${postId}`, {\n      method: \"DELETE\",\n      headers: {\n        Accept: \"application/json\",\n        \"Content-Type\": \"application/json\",\n        Authorization: `Bearer ${token}`,\n      },\n    });\n    return response.json();\n  } catch (err) {\n    return console.log(err);\n  }\n};\nexport const update = async (postId, token, post) => {\n  //console.log(postId, token, post);\n  try {\n    const response = await axios(`/api/post/${postId}`, {\n      method: \"PUT\",\n      headers: {\n        Accept: \"application/json\",\n        Authorization: `Bearer ${token}`,\n      },\n      data: post,\n    });\n    if (response) {\n      return response;\n    }\n  } catch (err) {\n    console.error(err);\n    if (err.response.data) {\n      return err.response.data;\n    }\n  }\n};\n\nexport const comment = (userId, token, postId, comment) => {\n  return fetch(`/api/post/comment`, {\n    method: \"PUT\",\n    headers: {\n      Accept: \"application/json\",\n      \"Content-Type\": \"application/json\",\n      Authorization: `Bearer ${token}`,\n    },\n    body: JSON.stringify({ userId, postId, comment }),\n  })\n    .then((response) => {\n      return response.json();\n    })\n    .catch((err) => console.log(err));\n};\n\nexport const uncomment = (userId, token, postId, comment) => {\n  return fetch(`/api/post/uncomment`, {\n    method: \"PUT\",\n    headers: {\n      Accept: \"application/json\",\n      \"Content-Type\": \"application/json\",\n      Authorization: `Bearer ${token}`,\n    },\n    body: JSON.stringify({ userId, postId, comment }),\n  })\n    .then((response) => {\n      return response.json();\n    })\n    .catch((err) => console.log(err));\n};\n","import React, { Component } from \"react\";\nimport { isAuthenticated } from \"../auth\"; // eslint-disable-next-line\nimport { Redirect } from \"react-router-dom\";\nimport { create } from \"./apiPost\";\nimport CKEditor from \"@ckeditor/ckeditor5-react\";\nimport DecoupledEditor from \"@ckeditor/ckeditor5-build-decoupled-document\";\n\nclass Post extends Component {\n  constructor() {\n    super();\n    this.state = {\n      title: \"\",\n      body: \"\",\n      photo: \"\",\n      error: \"\",\n      user: {},\n      fileSize: 0,\n      loading: false,\n      redirect: false,\n    };\n  }\n  componentDidMount() {\n    this.postData = new FormData(); // browser api by default in chrome\n    const user = isAuthenticated().user;\n    this.setState({ user });\n  }\n  handleChange = (name) => (event) => {\n    this.setState({ error: \"\" });\n    const value = name === \"photo\" ? event.target.files[0] : event.target.value;\n    const fileSize = name === \"photo\" ? event.target.files[0].size : 0;\n    this.postData.append(name, value);\n    this.setState({ [name]: value, fileSize });\n  };\n  clickSubmit = (event) => {\n    event.preventDefault();\n    this.setState({ loading: true });\n    if (this.isValid()) {\n      const userId = isAuthenticated().user._id;\n      const token = isAuthenticated().token;\n\n      create(userId, token, this.postData).then((data) => {\n        if (data.error) {\n          this.setState({ error: data.error, loading: false });\n        } else {\n          this.setState({\n            loading: false,\n            redirect: \"true\",\n            title: \"\",\n            body: \"\",\n            photo: \"\",\n            error: \"\",\n          });\n        }\n      });\n    }\n  };\n  isValid = () => {\n    const { title, body, fileSize } = this.state;\n    if (fileSize > 1000000) {\n      this.setState({\n        error: \"File size should be less than 100kb\",\n        loading: false,\n      });\n      return false;\n    }\n    if (title.length >= 1 && body.length <= 5) {\n      this.setState({\n        error: \"All fields must be at least 6 characters long\",\n        loading: false,\n      });\n      return false;\n    }\n    return true;\n  };\n\n  render() {\n    const { loading, redirect, user } = this.state;\n    if (redirect) {\n      return <Redirect to={`/user/${user._id}`} />;\n    }\n    return (\n      <div className=\"container\" style={{ marginTop: \"1vh\", padding: \"5vw\" }}>\n        <div className=\"card cloudy-knoxville-gradient\">\n          <h2 className=\"card-header text-center\">\n            <strong>Create your <span style ={{color : \"gold\"}}>Awesome!</span> blog</strong>\n          </h2>\n          <div className=\"card-body px-lg-5 pt-0\">\n            {loading ? \"Loading...\" : null}\n            <form\n              onSubmit={this.clickSubmit}\n              encType=\"multipart/form-data\"\n              className=\"text-center\"\n              style={{ color: \"#757575\" }}\n            >\n              <div className=\"form\">\n                <div className=\"md-form\">\n                  <input\n                    type=\"file\"\n                    accept=\"image/*\"\n                    required=\"required\"\n                    onChange={this.handleChange(\"photo\")}\n                    className=\"form-control\"\n                  />\n                </div>\n              </div>\n              <div className=\"form\">\n                <div className=\"md-form\">\n                  <input\n                    autoCapitalize=\"true\"\n                    autoComplete=\"post\"\n                    type=\"text\"\n                    required=\"required\"\n                    onChange={this.handleChange(\"title\")}\n                    id=\"materialRegisterFormLastName\"\n                    className=\"form-control\"\n                  />\n                  <label htmlFor=\"materialRegisterFormLastName\">Your Awesome title </label>\n                </div>\n              </div>\n              <div className=\"md-form\">\n                <CKEditor\n                  onInit={(editor) => {\n                    console.log(\"Editor is ready to use!\", editor);\n                    // Insert the toolbar before the editable area.\n                    editor.ui\n                      .getEditableElement()\n                      .parentElement.insertBefore(\n                        editor.ui.view.toolbar.element,\n                        editor.ui.getEditableElement()\n                      );\n                  }}\n                  onChange={(event, editor) => {\n                    const data = editor.getData();\n                    this.postData.append(\"body\", data);\n                    this.setState({ body: data });\n                    //console.log(data);\n                  }}\n                  editor={DecoupledEditor}\n                  data=\"<p>Create Your Content</p><br/><br/><br/><br/><br/><br/>\"\n                />\n              </div>\n              <button\n                onClick={this.clickSubmit}\n                className=\"btn btn-outline-info btn-rounded w-50 my-4 waves-effect z-depth-0\"\n                type=\"submit\"\n              >\n                Create\n              </button>\n              <button\n                onClick={() => this.props.history.push(\"/\")}\n                className=\"btn btn-outline-danger btn-rounded my-4 waves-effect z-depth-0\"\n              \n              >\n                Cancel\n              </button>\n            </form>\n          </div>\n        </div>\n      </div>\n    );\n  }\n}\n\nexport default Post;\n"],"sourceRoot":""}